{% extends 'base.html' %}
{% block content %}
<!-- Breadcrumb Navigation -->
<div class="breadcrumbs text-gray-400 mb-6">
  <a href="{{ url_for('dashboard') }}" class="text-blue-500 hover:underline">Home</a>
  {% for f in breadcrumbs %}
  &raquo; <a href="{{ url_for('folder_view', folder_id=f.id) }}" class="text-blue-500 hover:underline">{{ f.name }}</a>
  {% endfor %}
</div>

<!-- Main Content Section -->
<section class="grid md:grid-cols-2 gap-6">

  <!-- Folders Section -->
  <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
    <h2 class="text-2xl font-bold text-white mb-4">Folders</h2>
    <ul class="list-disc pl-6 space-y-3">
      {% for f in root_folders %}
      <li>
        <a href="{{ url_for('folder_view', folder_id=f.id) }}" class="text-blue-400 hover:text-blue-300">üìÅ {{ f.name
          }}</a>
      </li>
      {% else %}
      <li class="text-gray-400">No folders.</li>
      {% endfor %}
    </ul>

    <!-- Create Folder Form -->
    <form action="{{ url_for('folder_create') }}" method="post" class="mt-4">
      <div class="flex items-center space-x-4">
        <input type="text" name="name" placeholder="New folder name"
          class="p-2 w-full rounded bg-gray-700 text-white placeholder-gray-500" required>
        {% if current_folder %}
        <input type="hidden" name="parent_id" value="{{ current_folder.id }}">
        {% endif %}
        <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-400">+ Create
          Folder</button>
      </div>
    </form>
  </div>

  <!-- Files Section -->
  <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
    <h2 class="text-2xl font-bold text-white mb-4">Your Files</h2>
    <ul class="list-disc pl-6 space-y-3">
      {% for r in resources %}
      <li>
        <a href="{{ url_for('resource_detail', resource_id=r.id) }}" class="text-blue-400 hover:text-blue-300">üìÑ {{
          r.title }}</a>
        <span class="text-gray-400">({{ r.subject or '‚Äî' }})</span>
        {% if r.avg_rating %}
        <span class="badge text-yellow-300">{{ r.avg_rating }}/10</span>
        {% endif %}
      </li>
      {% else %}
      <li class="text-gray-400">No files yet. Upload below.</li>
      {% endfor %}
    </ul>
  </div>
</section>

<!-- Upload Section -->
<h2 class="text-3xl font-bold text-white mt-8 mb-4">Upload New File</h2>
<form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data"
  class="bg-gray-800 p-6 rounded-lg shadow-lg">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Title and Author -->
    <label class="text-white">
      Title
      <input name="title" placeholder="e.g., Linear Algebra Notes"
        class="p-3 w-full rounded bg-gray-700 text-white mt-2" required>
    </label>
    <label class="text-white">
      Author
      <input name="author" placeholder="Author/Creator" class="p-3 w-full rounded bg-gray-700 text-white mt-2">
    </label>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
    <!-- Subject and Folder -->
    <label class="text-white">
      Subject
      <input name="subject" placeholder="e.g., Mathematics" class="p-3 w-full rounded bg-gray-700 text-white mt-2">
    </label>
    <label class="text-white">
      Folder
      <select name="folder_id" class="p-3 w-full rounded bg-gray-700 text-white mt-2">
        <option value="">(none)</option>
        {% if current_folder %}
        <option value="{{ current_folder.id }}" selected>{{ current_folder.name }}</option>
        {% endif %}
        {% for f in breadcrumbs %}
        <option value="{{ f.id }}">{{ f.name }}</option>
        {% endfor %}
      </select>
    </label>
  </div>

  <!-- Description and File Upload -->
  <label class="text-white mt-4">
    Description
    <textarea name="description" rows="3" placeholder="Optional notes..."
      class="p-3 w-full rounded bg-gray-700 text-white mt-2"></textarea>
  </label>
  <label class="text-white mt-4">
    File
    <input type="file" name="file" class="p-3 w-full rounded bg-gray-700 text-white mt-2" required>
  </label>

  <button type="submit" class="w-full py-3 mt-6 bg-blue-500 text-white rounded hover:bg-blue-400">Upload</button>
</form>
{% endblock %}